---
sidebar_position: 2
tags: [flakey, containers]
---

import { FAQ } from '@site/src/components/FAQ';

# Aguardando Portas

Aguarda as portas especificadas se tornarem ativas.

## waitForPort

```ts
import { waitForPort } from 'poku';

await waitForPort(3000, {
  delay: 0,
  interval: 100,
  timeout: 60000,
  host: 'localhost',
});
```

<hr />

<FAQ title='Options' >

```ts
export type WaitForPortOptions = {
  /**
   * Intervalo de tentativa em milissegundos
   *
   * ---
   *
   * @default 100
   */
  interval?: number;
  /**
   * Tempo limite em milissegundos
   *
   * ---
   *
   * @default 60000
   */
  timeout?: number;
  /**
   * Atrasa o in√≠cio e o fim pelo n√∫mero definido de milissegundos.
   *
   * ---
   *
   * @default 0
   */
  delay?: number;
  /**
   * Host para verificar a porta.
   *
   * ---
   *
   * @default "localhost"
   */
  host?: string;
};
```

</FAQ>

<hr />

## Exemplos

### Aguardando M√∫ltiplas Portas

```ts
import { waitForPort } from 'poku';

await Promise.all([
  waitForPort(3000),
  waitForPort(4000),
  waitForPort(5000),
  waitForPort(6000),
]);
```

### Aguardando um Servi√ßo de Container na Porta 3000

```ts
import { docker, waitForPort } from 'poku';

// destaca-in√≠cio
const compose = docker.compose();

await compose.up();
// destaca-fim
await waitForPort(3000, { delay: 100 });

// destaca-in√≠cio
const res = await fetch('http://localhost:3000');
// destaca-fim

/**
 * Os testes v√™m aqui üß™
 */

// destaca-in√≠cio
await compose.down();
// destaca-fim
```

<hr />

:::tip

O **Poku** exp√µe um auxiliar `sleep` m√≠nimo que apenas espera por milissegundos, al√©m do `waitForPort`:

```ts
import { sleep } from 'poku';

// Aguarda por 1 segundo
await sleep(1000);
```

:::
