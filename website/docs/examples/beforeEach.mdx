---
sidebar_position: 1
---

# beforeEach and afterEach

:::info
I aim to present an alternative that leverages native JavaScript, not to dissuade the use of current methods ğŸ™‹ğŸ»â€â™‚ï¸
:::

## Basically...

When running our code, we just keep things as we want them, right?

```ts
let step = 0;

const firstStep = () => (step = 1);
const secondStep = () => (step = 2);
const thirdStep = () => (step = 3);

firstStep();
secondStep();
thirdStep();
```

So, by creating **Poku**, my aim is to show that testing can be **simpler**:

```ts
import { assert } from 'poku';
import { prepare, clear } from './my-code.js';

// Setup tasks traditionally done in "beforeEach" can be handled directly
await prepare();

// Describing it
assert(
  true,
  'Running after my previous requeriments and before the next ones ğŸš€'
);

// Cleanup tasks traditionally done in "afterEach" can be managed after the tests directly
await clear();
```

:::tip
**Poku**'s `assert` will use the message exactly as it is when using `describe` and `it`. <br />
Your **Poku** is waiting for you ğŸ·âœ¨
:::

<hr />

## A Complex Case

**Imagine these steps to perform a test:**

1. Perform **Unit Tests** suite in parallel
2. Clear and Populate the Database
3. Check for **Expected Successes Integration** suite sequentially
4. Clear and Populate the Database â€” again
5. Check for **Expected Failures Integration** suite sequentially

**Requirements:**

Each step requires success to be processed.

**Directory Structure:**

```bash
â”œâ”€â”€ .
â”œâ”€â”€ test
â”‚ â”œâ”€â”€ unit
â”‚ â”œâ”€â”€ integration
â”‚ â”‚ â”œâ”€â”€ successes
â”‚ â”‚ â”‚ â””â”€â”€ **/.spec.js
â”‚ â”‚ â””â”€â”€ failures
â”‚ â”‚   â””â”€â”€ **/.spec.js
â”‚ â”œâ”€ run.test.js # The runner
â”‚ â”œâ”€ tools.test.js
```

> Do we really need to complicate things even more by creating advanced tests runs to run our already complex tests? ğŸ˜…

### Poku's Solution âœ¨

```ts
import { poku, assert } from 'poku';
import { recreateDatabase } from './tools.test.js';

const unitCode = await poku('test/unit', {
  parallel: true,
  noExit: true,
});

assert.strictEqual(0, unitCode, 'Running Unit Tests');

await assert.doesNotReject(
  recreateDatabase(),
  'Preparing DB for Successes Integration Tests'
);

const successesCode = await poku('test/integration/successes', {
  noExit: true,
});

assert.strictEqual(0, successesCode, 'Running Successes Integration Tests');

await assert.doesNotReject(
  recreateDatabase(),
  'Preparing DB for Successes Integration Tests'
);

const failuresCode = await poku('test/integration/failures', {
  noExit: true,
});

assert.strictEqual(0, failuresCode, 'Running Failures Integration Tests');
```

> Why comment the code if we can do it better? ğŸ§™ğŸ»

**Finally**

```bash
npx poku test/run.test.js
```

> Or `npx poku test/run.test.ts` for **TypeScript**.
