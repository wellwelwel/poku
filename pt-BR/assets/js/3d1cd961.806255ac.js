"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[6776],{12566:(e,n,o)=>{o.d(n,{T:()=>t});var s=o(41622),r=o(74848);const t=({children:e,open:n,title:o})=>(0,r.jsx)(s.A,{open:n,className:"faq",summary:(0,r.jsx)("summary",{children:(0,r.jsx)("strong",{children:o})}),children:(0,r.jsx)("section",{children:e})})},21686:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>p,frontMatter:()=>a,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"documentation/helpers/containers","title":"\ud83d\udc33 Cont\xeaineres","description":"Uma API m\xednima para auxiliar testes que requerem cont\xeaineres ou testes que s\xe3o executados dentro de cont\xeaineres.","source":"@site/i18n/pt-BR/docusaurus-plugin-content-docs/current/documentation/helpers/containers.mdx","sourceDirName":"documentation/helpers","slug":"/documentation/helpers/containers","permalink":"/pt-BR/docs/documentation/helpers/containers","draft":false,"unlisted":false,"editUrl":"https://github.com/wellwelwel/poku/tree/main/website/docs/documentation/helpers/containers.mdx","tags":[{"inline":true,"label":"containers","permalink":"/pt-BR/docs/tags/containers"}],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6,"tags":["containers"]},"sidebar":"docs","previous":{"title":"No C\xf3digo","permalink":"/pt-BR/docs/documentation/helpers/before-after-each/in-code"},"next":{"title":"\ud83d\udd01 Start Script","permalink":"/pt-BR/docs/documentation/helpers/startScript"}}');var r=o(74848),t=o(28453),i=o(12566);const a={sidebar_position:6,tags:["containers"]},c="\ud83d\udc33 Cont\xeaineres",l={},d=[{value:"docker",id:"docker",level:2},{value:"compose",id:"compose",level:3},{value:"dockerfile",id:"dockerfile",level:3},{value:"Exemplos Reais",id:"exemplos-reais",level:2}];function m(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"-cont\xeaineres",children:"\ud83d\udc33 Cont\xeaineres"})}),"\n",(0,r.jsx)(n.p,{children:"Uma API m\xednima para auxiliar testes que requerem cont\xeaineres ou testes que s\xe3o executados dentro de cont\xeaineres."}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["Esse auxiliar pressup\xf5e que voc\xea j\xe1 tem uma compreens\xe3o b\xe1sica de como o ",(0,r.jsx)(n.strong,{children:"Docker"})," funciona."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"docker",children:"docker"}),"\n",(0,r.jsx)(n.h3,{id:"compose",children:"compose"}),"\n",(0,r.jsxs)(n.p,{children:["Inicie cont\xeaineres a partir de um ",(0,r.jsx)(n.strong,{children:"docker-compose.yml"})," em segundo plano."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"import { docker } from 'poku';\n\nconst compose = docker.compose();\n\n// Inicia o(s) cont\xeainer(es)\nawait compose.up();\n\n/**\n * Testes v\xeam aqui \ud83e\uddea\n */\n\n// Interrompe o(s) cont\xeainer(es)\nawait compose.down();\n"})}),"\n",(0,r.jsx)(i.T,{title:"Options",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:'export type DockerComposeConfigs = {\n  /**\n   * Especifica o caminho do **docker-compose.yml**\n   *\n   * ---\n   *\n   * @default "./docker-compose.yml"\n   */\n  file?: string;\n\n  /**\n   * Especifica o nome do projeto.\n   */\n  projectName?: string;\n\n  /**\n   * Especifica um caminho `.env` para o **docker-compose.yml**.\n   */\n  envFile?: string;\n\n  /**\n   * Define o diret\xf3rio raiz onde o processo ir\xe1 rodar.\n   *\n   * ---\n   *\n   * @default "."\n   */\n  cwd?: string;\n\n  /**\n   * For\xe7a a reconstru\xe7\xe3o das imagens (**Dockerfile**).\n   */\n  build?: boolean;\n\n  /**\n   * Inicia apenas um servi\xe7o espec\xedfico do **docker-compose.yml**.\n   */\n  serviceName?: string;\n\n  /**\n   * N\xe3o executa o cont\xeainer em segundo plano e retorna o resultado de sa\xedda do processo do cont\xeainer (boolean).\n   *\n   * - Defina como `false` para testar se um cont\xeainer foi executado e finalizado com sucesso.\n   *\n   * ---\n   *\n   * @default true\n   */\n  detach?: boolean;\n\n  /**\n   * Mostra logs do **Docker** em tempo real.\n   */\n  verbose?: boolean;\n};\n'})})}),"\n",(0,r.jsx)("hr",{}),"\n",(0,r.jsx)(n.h3,{id:"dockerfile",children:"dockerfile"}),"\n",(0,r.jsxs)(n.p,{children:["Constr\xf3i e inicia cont\xeaineres a partir de ",(0,r.jsx)(n.strong,{children:"Dockerfiles"})," em segundo plano."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"import { docker } from 'poku';\n\nconst dockerfile = docker.dockerfile({\n  containerName: 'nome-do-cont\xeainer',\n  tagName: 'nome-da-imagem',\n});\n\n// Constr\xf3i a imagem a partir do Dockerfile\nawait dockerfile.build();\n\n// Inicia o cont\xeainer\nawait dockerfile.start();\n\n/**\n * Testes v\xeam aqui \ud83e\uddea\n */\n\n// Interrompe e remove tanto o cont\xeainer quanto a imagem\nawait dockerfile.remove();\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Voc\xea tamb\xe9m pode usar ",(0,r.jsx)(n.code,{children:".stop()"})," para interromper o cont\xeainer de maneira suave sem remov\xea-lo."]}),"\n"]}),"\n",(0,r.jsx)(i.T,{title:"Options",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:'export type DockerfileConfigs = {\n  /**\n   * Especifica o nome da imagem\n   *\n   * Por exemplo, `"nome"`, `"nome:tag"`.\n   */\n  tagName: string;\n\n  /**\n   * Especifica o nome do cont\xeainer.\n   */\n  containerName: string;\n\n  /**\n   * Especifica o caminho do **Dockerfile**\n   *\n   * ---\n   *\n   * @default "./Dockerfile"\n   */\n  file?: string;\n\n  /**\n   * Especifica o caminho de contexto do **Dockerfile**\n   *\n   * - \xc9 diferente do `cwd`.\n   *\n   * ---\n   *\n   * @default "."\n   */\n  context?: string;\n\n  /**\n   * Especifica as portas a serem expostas.\n   *\n   * Por exemplo, `"6000:6000"`, `"8080:80"`, `"127.0.0.1:3306:3306"`.\n   */\n  ports?: string[];\n\n  /**\n   * Especifica as vari\xe1veis de ambiente do cont\xeainer.\n   *\n   * Por exemplo, `"VAR1"`, `"VAR1=value1"`\n   */\n  environments?: string[];\n\n  /**\n   * Especifica um caminho para o arquivo `.env` no **Dockerfile**.\n   */\n  envFile?: string;\n\n  /**\n   * For\xe7a a constru\xe7\xe3o da imagem sem cache.\n   */\n  cache?: boolean;\n\n  /**\n   * N\xe3o executa o cont\xeainer em segundo plano e retorna o resultado de sa\xedda do processo do cont\xeainer (boolean).\n   *\n   * - Defina como `false` para testar se um cont\xeainer foi executado e finalizado com sucesso.\n   *\n   * ---\n   *\n   * @default true\n   */\n  detach?: boolean;\n\n  /**\n   * Define o diret\xf3rio raiz onde o processo ir\xe1 rodar.\n   *\n   * ---\n   *\n   * @default "."\n   */\n  cwd?: string;\n\n  /**\n   * Mostra logs do **Docker** em tempo real.\n   */\n  verbose?: boolean;\n};\n'})})}),"\n",(0,r.jsx)("hr",{}),"\n",(0,r.jsx)(n.h2,{id:"exemplos-reais",children:"Exemplos Reais"}),"\n",(0,r.jsxs)(n.p,{children:["Testes realizados dentro de um cont\xeainer (",(0,r.jsx)(n.strong,{children:"docker-compose.yml"}),") em um servi\xe7o espec\xedfico com imagens personalizadas (",(0,r.jsx)(n.strong,{children:"Dockerfile"}),"), retornando a sa\xedda, interrompendo os cont\xeaineres e limpando as imagens:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/wellwelwel/poku/blob/main/test/compatibility/bun-canary.test.ts",children:"test/compatibility/bun-canary.test.ts"})}),"\n"]}),"\n",(0,r.jsx)("hr",{}),"\n",(0,r.jsxs)(n.p,{children:["Testes realizados dentro de um cont\xeainer (",(0,r.jsx)(n.strong,{children:"Dockerfile"}),"), retornando a sa\xedda, interrompendo o cont\xeainer e limpando a imagem:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/wellwelwel/poku/blob/main/test/compatibility-by-dockerfile/bun-canary.test.ts",children:"test/compatibility-by-dockerfile/bun-canary.test.ts"})}),"\n"]}),"\n",(0,r.jsx)("hr",{}),"\n",(0,r.jsx)(n.p,{children:"Inicia um cont\xeainer antes de toda a su\xedte de testes e o interrompe ao finalizar:"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["Exemplo de ",(0,r.jsx)(n.em,{children:"API"})," do ",(0,r.jsx)(n.strong,{children:"Poku"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"import { poku, docker, exit } from 'poku';\n\nconst compose = docker.compose({ cwd: './test/docker' });\n\n// Remove o cont\xeainer se ele j\xe1 existir antes de iniciar\nawait compose.down();\n\n// Inicia o cont\xeainer\nawait compose.up();\n\nconst result = await poku('./test/integration', {\n  noExit: true,\n});\n\n// Interrompe o cont\xeainer\nawait compose.down();\n\n// Mostra os resultados dos testes e finaliza o processo com o c\xf3digo de sa\xedda do teste.\nexit(result);\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"node run.test.mjs\n"})}),"\n",(0,r.jsx)("hr",{}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["Esta n\xe3o \xe9 uma ",(0,r.jsx)(n.em,{children:"API"})," completa e robusta projetada para criar um ",(0,r.jsx)(n.em,{children:"ORM"})," para ",(0,r.jsx)(n.strong,{children:"Docker"}),", mas uma ",(0,r.jsx)(n.strong,{children:"API"})," m\xednima focada em necessidades comuns de ",(0,r.jsx)(n.strong,{children:"integra\xe7\xe3o"})," e ",(0,r.jsx)(n.strong,{children:"teste de ponta a ponta"}),"."]})})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(m,{...e})}):m(e)}},28453:(e,n,o)=>{o.d(n,{R:()=>i,x:()=>a});var s=o(96540);const r={},t=s.createContext(r);function i(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(t.Provider,{value:n},e.children)}},41622:(e,n,o)=>{o.d(n,{A:()=>x});var s=o(96540),r=o(34164),t=o(63427),i=o(92303),a=o(41422);const c={details:"details_lb9f",isBrowser:"isBrowser_bmU9",collapsibleContent:"collapsibleContent_i85q"};var l=o(74848);function d(e){return!!e&&("SUMMARY"===e.tagName||d(e.parentElement))}function m(e,n){return!!e&&(e===n||m(e.parentElement,n))}function p({summary:e,children:n,...o}){(0,t.A)().collectAnchor(o.id);const p=(0,i.A)(),u=(0,s.useRef)(null),{collapsed:h,setCollapsed:x}=(0,a.u)({initialState:!o.open}),[f,j]=(0,s.useState)(o.open),g=s.isValidElement(e)?e:(0,l.jsx)("summary",{children:e??"Details"});return(0,l.jsxs)("details",{...o,ref:u,open:f,"data-collapsed":h,className:(0,r.A)(c.details,p&&c.isBrowser,o.className),onMouseDown:e=>{d(e.target)&&e.detail>1&&e.preventDefault()},onClick:e=>{e.stopPropagation();const n=e.target;d(n)&&m(n,u.current)&&(e.preventDefault(),h?(x(!1),j(!0)):x(!0))},children:[g,(0,l.jsx)(a.N,{lazy:!1,collapsed:h,onCollapseTransitionEnd:e=>{x(e),j(!e)},children:(0,l.jsx)("div",{className:c.collapsibleContent,children:n})})]})}const u={details:"details_b_Ee"},h="alert alert--info";function x({...e}){return(0,l.jsx)(p,{...e,className:(0,r.A)(h,u.details,e.className)})}}}]);